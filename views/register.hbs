<div class="container mt-2" id="alert" style="position: fixed; top: 1rem; z-index: 999">
</div>
<div class="container my-3 d-flex justify-content-center">
  <div class="card" style="width: 36rem;">
    <div class="card-body">
      <img src="images/logo.png" class="rounded mx-auto d-block" alt="website logo" style="width: 10rem">
      <h4 class="card-title text-center font-weight-bold">Account Register</h4>
      <form class="needs-validation" novalidate onsubmit="submitForm()">
        <div class="form-group">
          <label for="inputName">Name</label>
          <input type="text" class="form-control" id="inputName" aria-describedby="nameHelp" required>
          <div class="invalid-feedback">
            Please provide a valid name.
          </div>
        </div>
        <div class="form-group">
          <label for="inputEmail">Email</label>
          <input type="email" class="form-control" id="inputEmail" required>
          <div class="invalid-feedback">
            Please provide a valid email.
          </div>
        </div>
        <div class="form-group">
          <label for="inputPassword1">Password</label>
          <input type="password" class="form-control" id="inputPassword1" aria-describedby="passwordHelp" required>
          <small id="passwordHelp" class="form-text text-muted">Password must be atleast 6 character long.</small>
        </div>
        <div class="form-group">
          <label for="inputPassword2">Confirm Password</label>
          <input type="password" class="form-control" id="inputPassword2" required>
        </div>
        <button type="submit" class="btn btn-primary">Submit</button>
      </form>
    </div>
  </div>
</div>

<script>
  // Example starter JavaScript for disabling form submissions if there are invalid fields

  function submitForm() {
    let name = document.getElementById('inputName').value;
    let email = document.getElementById('inputEmail').value;
    let password = document.getElementById('inputPassword1').value;
    let confirmPassword = document.getElementById('inputPassword2').value;
    let passwordValidationRegex = /[\w|\W]{6,}/;
    let validPassword = passwordValidationRegex.test(password);

    document.getElementsByClassName('needs-validation')[0].classList.add('was-validated');

    if(validPassword && password === confirmPassword && name && email) {
      stopPageRefresh();
      fetch('http://localhost:3000/register', {
        method: 'POST',
        headers: {
          "Content-Type": "application/json",
          'auth': '1234'
        },
        body: JSON.stringify({
          name,
          email,
          password
        })
      })
      .then(function (data) {
        if(data.status === 200) {
          console.log('Request success: ', data);
          window.location.replace("http://localhost:3000/");
        }
        else{
          return showAlert('alert-warning', 'Problem Registering Server Error.');
        }
      })
      .catch(function (error) {
        return showAlert('alert-warning', 'Problem Registering. Check Internet connection');
      });
    }else {
      stopPageRefresh();
      if(!validPassword && password){
        return showAlert('alert-warning', 'Password must be at least 6 characters.');
      }
      if(password !== confirmPassword){

        return  showAlert('alert-warning', 'Password did not Match.');
      }
    }
  }

  function stopPageRefresh() {
    event.preventDefault();
    event.stopPropagation();
  }

  function showAlert(type, text) {
    $('.alert').alert();
    document.getElementById('alert').innerHTML = `<div class="alert ${type} alert-dismissible fade show"  id="alert" role="alert">
              <div id="alert-text">${text}</div>
              <button type="button" class="close" data-dismiss="alert" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>`;
  }

</script>